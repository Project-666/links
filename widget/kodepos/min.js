async function getProvinces(){try{let t=await fetch("./data/provinces.json");if(!t.ok)throw Error("Network response was not ok");let e=await t.json();return e}catch(n){return console.error("Error loading provinces:",n),[]}}async function getCities(){try{let t=await fetch("./data/cities.json");if(!t.ok)throw Error("Network response was not ok");let e=await t.json();return e}catch(n){return console.error("Error loading cities:",n),[]}}async function getDistricts(){try{let t=await fetch("./data/districts.json");if(!t.ok)throw Error("Network response was not ok");let e=await t.json();return e}catch(n){return console.error("Error loading districts:",n),[]}}async function getSubDistricts(){try{let t=await fetch("./data/subDistricts.json");if(!t.ok)throw Error("Network response was not ok");let e=await t.json();return e}catch(n){return console.error("Error loading subDistricts:",n),[]}}async function getPostalCodes(){try{let t=await fetch("./data/postalCodes.json");if(!t.ok)throw Error("Network response was not ok");let e=await t.json();return e}catch(n){return console.error("Error loading postalCodes:",n),[]}}const errContainer=document.getElementById("error"),errorMessage=document.getElementById("error-message");function handleSearch(){let t=document.getElementById("search-input").value.trim();if(t){let e=`/index.html?kota=${encodeURIComponent(t)}`;window.location.href=e}else errContainer.style.display="block",errorMessage.textContent="*Masukkan nama kota untuk mencari kode pos."}async function main(){let t=document.getElementById("loading"),e=document.getElementById("city-name"),n=document.getElementById("prov-name"),r=document.getElementById("postal-codes-table"),a=document.getElementById("table"),o=document.getElementById("info"),i=document.getElementById("zipCount");try{var s,d,l;t.style.display="block";let c=await getProvinces(),y=await getCities(),g=await getDistricts(),u=await getSubDistricts(),k=await getPostalCodes();r.innerHTML="",document.getElementById("prov-count").innerHTML=c.length,document.getElementById("city-count").innerHTML=y.length,document.getElementById("dis-count").innerHTML=g.length,document.getElementById("subdis-count").innerHTML=u.length,document.getElementById("pC-count").innerHTML=k.length;let m=new URLSearchParams(window.location.search),w=m.get("kota");if(!w){errContainer.style.display="block",errorMessage.textContent="*Cari berdasarkan nama kota/kabupaten";return}let h=y.find(t=>t.city_name.toLowerCase()===w.toLowerCase());if(!h){errContainer.style.display="block",errorMessage.textContent=`*Kota/kabupaten "${w}" tidak ada di database kami`;return}let f=h.city_id,p=(s=f,g.filter(t=>t.city_id===s));p.length,p.forEach(t=>{var e;e=t.dis_id,u.filter(t=>t.dis_id===e)});let E=(d=f,k.filter(t=>t.city_id===d)),b=E.length,C=c.find(t=>t.prov_id===h.prov_id),B=C?C.prov_name:"Unknown";E.forEach((t,e)=>{let n=document.createElement("tr"),a=g.find(e=>e.dis_id===t.dis_id),o=u.find(e=>e.subdis_id===t.subdis_id);n.innerHTML=`
                <td>${e+1}</td>
                <td>${B}</td>
                <td>${h.city_name}</td>
                <td>${a?a.dis_name:"Unknown"}</td>
                <td>${o?o.subdis_name:"Unknown"}</td>
                <td>${t.postal_code}</td>
            `,r.appendChild(n)}),o.style.display="block",e.textContent=h.city_name,n.textContent=B,l=`Kode Pos ${h.city_name}`,document.title=l,a.style.display="block",i.textContent=b}catch(I){console.error("Error loading data:",I);return}finally{t.style.display="none"}}window.onload=function(){document.getElementById("search-button").addEventListener("click",handleSearch)},main();const refreshButton=document.getElementById("refresh-button");refreshButton.addEventListener("click",()=>{main()});
